Started by user anjireddy-jenkins

Obtained Jenkinsfile from git https://github.com/anjilinux/project-mlflow-jenkins-Credit-Card-Fraud-Detection.git
[Pipeline] Start of Pipeline
[Pipeline] node
Running on Jenkins
 in /var/lib/jenkins/workspace/credit-card
[Pipeline] {
[Pipeline] stage
[Pipeline] { (Declarative: Checkout SCM)
[Pipeline] checkout
Selected Git installation does not exist. Using Default
The recommended git tool is: NONE
No credentials specified
 > git rev-parse --resolve-git-dir /var/lib/jenkins/workspace/credit-card/.git # timeout=10
Fetching changes from the remote Git repository
 > git config remote.origin.url https://github.com/anjilinux/project-mlflow-jenkins-Credit-Card-Fraud-Detection.git # timeout=10
Fetching upstream changes from https://github.com/anjilinux/project-mlflow-jenkins-Credit-Card-Fraud-Detection.git
 > git --version # timeout=10
 > git --version # 'git version 2.43.0'
 > git fetch --tags --force --progress -- https://github.com/anjilinux/project-mlflow-jenkins-Credit-Card-Fraud-Detection.git +refs/heads/*:refs/remotes/origin/* # timeout=10
 > git rev-parse refs/remotes/origin/master^{commit} # timeout=10
Checking out Revision b6bfe35a55af3e3af133b51c522bc44b7e4f545f (refs/remotes/origin/master)
 > git config core.sparsecheckout # timeout=10
 > git checkout -f b6bfe35a55af3e3af133b51c522bc44b7e4f545f # timeout=10
Commit message: "docker-change"
 > git rev-list --no-walk b6bfe35a55af3e3af133b51c522bc44b7e4f545f # timeout=10
[Pipeline] }
[Pipeline] // stage
[Pipeline] withEnv
[Pipeline] {
[Pipeline] withEnv
[Pipeline] {
[Pipeline] timeout
Timeout set to expire in 1 hr 0 min
[Pipeline] {
[Pipeline] stage
[Pipeline] { (Checkout Code)
[Pipeline] git
Selected Git installation does not exist. Using Default
The recommended git tool is: NONE
No credentials specified
 > git rev-parse --resolve-git-dir /var/lib/jenkins/workspace/credit-card/.git # timeout=10
Fetching changes from the remote Git repository
 > git config remote.origin.url https://github.com/anjilinux/project-mlflow-jenkins-Credit-Card-Fraud-Detection.git # timeout=10
Fetching upstream changes from https://github.com/anjilinux/project-mlflow-jenkins-Credit-Card-Fraud-Detection.git
 > git --version # timeout=10
 > git --version # 'git version 2.43.0'
 > git fetch --tags --force --progress -- https://github.com/anjilinux/project-mlflow-jenkins-Credit-Card-Fraud-Detection.git +refs/heads/*:refs/remotes/origin/* # timeout=10
 > git rev-parse refs/remotes/origin/master^{commit} # timeout=10
Checking out Revision b6bfe35a55af3e3af133b51c522bc44b7e4f545f (refs/remotes/origin/master)
 > git config core.sparsecheckout # timeout=10
 > git checkout -f b6bfe35a55af3e3af133b51c522bc44b7e4f545f # timeout=10
 > git branch -a -v --no-abbrev # timeout=10
 > git branch -D master # timeout=10
 > git checkout -b master b6bfe35a55af3e3af133b51c522bc44b7e4f545f # timeout=10
Commit message: "docker-change"
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Setup Virtual Environment)
[Pipeline] sh
+ python3 -m venv venv

+ . venv/bin/activate
+ deactivate nondestructive
+ [ -n  ]
+ [ -n  ]
+ hash -r
+ [ -n  ]
+ unset VIRTUAL_ENV
+ unset VIRTUAL_ENV_PROMPT
+ [ ! nondestructive = nondestructive ]
+ [  = cygwin ]
+ [  = msys ]
+ export VIRTUAL_ENV=/var/lib/jenkins/workspace/credit-card/venv
+ _OLD_VIRTUAL_PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/snap/bin
+ PATH=/var/lib/jenkins/workspace/credit-card/venv/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/snap/bin
+ export PATH
+ [ -n  ]
+ [ -z  ]
+ _OLD_VIRTUAL_PS1=$ 
+ PS1=(venv) $ 
+ export PS1
+ VIRTUAL_ENV_PROMPT=(venv) 
+ export VIRTUAL_ENV_PROMPT
+ hash -r
+ pip install -r requirements.txt
Requirement already satisfied: pandas in ./venv/lib/python3.12/site-packages (from -r requirements.txt (line 1)) (2.3.3)
atisfied: pyasn1<0.7.0,>=0.6.1 in ./venv/lib/python3.12/site-packages (from pyasn1-modules>=0.2.1->google-auth~=2.0->databricks-sdk<1,>=0.20.0->mlflow-skinny==3.9.0->mlflow->-r requirements.txt (line 4)) (0.6.2)
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Data Ingestion)
[Pipeline] sh
+ . venv/bin/activate
+ deactivate nondestructive
+ [ -n  ]
+ [ -n  ]
+ hash -r
+ [ -n  ]
+ unset VIRTUAL_ENV
+ unset VIRTUAL_ENV_PROMPT
+ [ ! nondestructive = nondestructive ]
+ [  = cygwin ]
+ [  = msys ]
+ export VIRTUAL_ENV=/var/lib/jenkins/workspace/credit-card/venv
+ _OLD_VIRTUAL_PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/snap/bin
+ PATH=/var/lib/jenkins/workspace/credit-card/venv/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/snap/bin
+ export PATH
+ [ -n  ]
+ [ -z  ]
+ _OLD_VIRTUAL_PS1=$ 
+ PS1=(venv) $ 
+ export PS1
+ VIRTUAL_ENV_PROMPT=(venv) 
+ export VIRTUAL_ENV_PROMPT
+ hash -r
+ python data_ingestion.py

[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Feature Engineering)
[Pipeline] sh
+ . venv/bin/activate
+ deactivate nondestructive
+ [ -n  ]
+ [ -n  ]
+ hash -r
+ [ -n  ]
+ unset VIRTUAL_ENV
+ unset VIRTUAL_ENV_PROMPT
+ [ ! nondestructive = nondestructive ]
+ [  = cygwin ]
+ [  = msys ]
+ export VIRTUAL_ENV=/var/lib/jenkins/workspace/credit-card/venv
+ _OLD_VIRTUAL_PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/snap/bin
+ PATH=/var/lib/jenkins/workspace/credit-card/venv/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/snap/bin
+ export PATH
+ [ -n  ]
+ [ -z  ]
+ _OLD_VIRTUAL_PS1=$ 
+ PS1=(venv) $ 
+ export PS1
+ VIRTUAL_ENV_PROMPT=(venv) 
+ export VIRTUAL_ENV_PROMPT
+ hash -r
+ python feature_engineering.py
[Pipeline] }
[Pipeline] // stage

[Pipeline] stage
[Pipeline] { (Data Preprocessing)
[Pipeline] sh
+ . venv/bin/activate
+ deactivate nondestructive
+ [ -n  ]
+ [ -n  ]
+ hash -r
+ [ -n  ]
+ unset VIRTUAL_ENV
+ unset VIRTUAL_ENV_PROMPT
+ [ ! nondestructive = nondestructive ]
+ [  = cygwin ]
+ [  = msys ]
+ export VIRTUAL_ENV=/var/lib/jenkins/workspace/credit-card/venv
+ _OLD_VIRTUAL_PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/snap/bin
+ PATH=/var/lib/jenkins/workspace/credit-card/venv/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/snap/bin
+ export PATH
+ [ -n  ]
+ [ -z  ]
+ _OLD_VIRTUAL_PS1=$ 
+ PS1=(venv) $ 
+ export PS1
+ VIRTUAL_ENV_PROMPT=(venv) 
+ export VIRTUAL_ENV_PROMPT
+ hash -r
+ python preprocessing.py

‚úÖ Clean data saved at /var/lib/jenkins/workspace/credit-card/clean_data.csv
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Model Training)
[Pipeline] sh
+ . venv/bin/activate
+ deactivate nondestructive
+ [ -n  ]
+ [ -n  ]
+ hash -r
+ [ -n  ]
+ unset VIRTUAL_ENV
+ unset VIRTUAL_ENV_PROMPT
+ [ ! nondestructive = nondestructive ]
+ [  = cygwin ]
+ [  = msys ]
+ export VIRTUAL_ENV=/var/lib/jenkins/workspace/credit-card/venv
+ _OLD_VIRTUAL_PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/snap/bin
+ PATH=/var/lib/jenkins/workspace/credit-card/venv/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/snap/bin
+ export PATH
+ [ -n  ]
+ [ -z  ]
+ _OLD_VIRTUAL_PS1=$ 
+ PS1=(venv) $ 
+ export PS1
+ VIRTUAL_ENV_PROMPT=(venv) 
+ export VIRTUAL_ENV_PROMPT
+ hash -r
+ export MLFLOW_TRACKING_URI=http://localhost:5555
+ export MLFLOW_EXPERIMENT_NAME=credit-card-fraud
+ python train.py

/var/lib/jenkins/workspace/credit-card/venv/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1833: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/var/lib/jenkins/workspace/credit-card/venv/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1833: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
/var/lib/jenkins/workspace/credit-card/venv/lib/python3.12/site-packages/sklearn/metrics/_classification.py:1833: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
2026/02/02 22:33:04 WARNING mlflow.models.model: `artifact_path` is deprecated. Please use `name` instead.

/var/lib/jenkins/workspace/credit-card/venv/lib/python3.12/site-packages/mlflow/models/model.py:1209: FutureWarning: Saving scikit-learn models in the pickle or cloudpickle format requires exercising caution because these formats rely on Python's object serialization mechanism, which can execute arbitrary code during deserialization.The recommended safe alternative is the 'skops' format.
  flavor.save_model(path=local_path, mlflow_model=mlflow_model, **kwargs)

              precision    recall  f1-score   support

           0       0.98      1.00      0.99       391
           1       0.00      0.00      0.00         9

    accuracy                           0.98       400
   macro avg       0.49      0.50      0.49       400
weighted avg       0.96      0.98      0.97       400

‚úÖ Model saved to model.pkl
üèÉ View run grandiose-stork-977 at: http://localhost:5555/#/experiments/70/runs/8fd6f8dd3939473891a891316fb03411
üß™ View experiment at: http://localhost:5555/#/experiments/70
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Model Evaluation)
[Pipeline] sh
+ . venv/bin/activate
+ deactivate nondestructive
+ [ -n  ]
+ [ -n  ]
+ hash -r
+ [ -n  ]
+ unset VIRTUAL_ENV
+ unset VIRTUAL_ENV_PROMPT
+ [ ! nondestructive = nondestructive ]
+ [  = cygwin ]
+ [  = msys ]
+ export VIRTUAL_ENV=/var/lib/jenkins/workspace/credit-card/venv
+ _OLD_VIRTUAL_PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/snap/bin
+ PATH=/var/lib/jenkins/workspace/credit-card/venv/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/snap/bin
+ export PATH
+ [ -n  ]
+ [ -z  ]
+ _OLD_VIRTUAL_PS1=$ 
+ PS1=(venv) $ 
+ export PS1
+ VIRTUAL_ENV_PROMPT=(venv) 
+ export VIRTUAL_ENV_PROMPT
+ hash -r
+ python evaluate.py

              precision    recall  f1-score   support

           0       0.99      1.00      1.00      1962
           1       1.00      0.74      0.85        38

    accuracy                           0.99      2000
   macro avg       1.00      0.87      0.92      2000
weighted avg       1.00      0.99      0.99      2000

[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Run Pytests)
[Pipeline] sh
+ . venv/bin/activate
+ deactivate nondestructive
+ [ -n  ]
+ [ -n  ]
+ hash -r
+ [ -n  ]
+ unset VIRTUAL_ENV
+ unset VIRTUAL_ENV_PROMPT
+ [ ! nondestructive = nondestructive ]
+ [  = cygwin ]
+ [  = msys ]
+ export VIRTUAL_ENV=/var/lib/jenkins/workspace/credit-card/venv
+ _OLD_VIRTUAL_PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/snap/bin
+ PATH=/var/lib/jenkins/workspace/credit-card/venv/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/snap/bin
+ export PATH
+ [ -n  ]
+ [ -z  ]
+ _OLD_VIRTUAL_PS1=$ 
+ PS1=(venv) $ 
+ export PS1
+ VIRTUAL_ENV_PROMPT=(venv) 
+ export VIRTUAL_ENV_PROMPT
+ hash -r
+ pwd
+ export PYTHONPATH=/var/lib/jenkins/workspace/credit-card
+ pytest test_data.py

============================= test session starts ==============================
platform linux -- Python 3.12.3, pytest-9.0.2, pluggy-1.6.0
rootdir: /var/lib/jenkins/workspace/credit-card
plugins: anyio-4.12.1
collected 2 items

test_data.py ..                                                          [100%]

============================== 2 passed in 0.38s ===============================
+ pytest test_model.py

============================= test session starts ==============================
platform linux -- Python 3.12.3, pytest-9.0.2, pluggy-1.6.0
rootdir: /var/lib/jenkins/workspace/credit-card
plugins: anyio-4.12.1
collected 1 item


.                                                          [100%]

=============================== warnings summary ===============================
test_model.py::test_model_prediction
  /var/lib/jenkins/workspace/credit-card/venv/lib/python3.12/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but RandomForestClassifier was fitted with feature names
    warnings.warn(

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
========================= 1 passed, 1 warning in 1.22s =========================
+ pytest test_api.py
============================= test session starts ==============================
platform linux -- Python 3.12.3, pytest-9.0.2, pluggy-1.6.0
rootdir: /var/lib/jenkins/workspace/credit-card
plugins: anyio-4.12.1
collected 1 item

test_api.py .                                                            [100%]

============================== 1 passed in 0.01s ===============================
+ pytest test_schema.py -W ignore::pydantic.PydanticDeprecatedSince20

============================= test session starts ==============================
platform linux -- Python 3.12.3, pytest-9.0.2, pluggy-1.6.0
rootdir: /var/lib/jenkins/workspace/credit-card
plugins: anyio-4.12.1
collected 2 items

test_schema.py ..                                                        [100%]

============================== 2 passed in 0.43s ===============================
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Schema Validation)
[Pipeline] sh
+ . venv/bin/activate
+ deactivate nondestructive
+ [ -n  ]
+ [ -n  ]
+ hash -r
+ [ -n  ]
+ unset VIRTUAL_ENV
+ unset VIRTUAL_ENV_PROMPT
+ [ ! nondestructive = nondestructive ]
+ [  = cygwin ]
+ [  = msys ]
+ export VIRTUAL_ENV=/var/lib/jenkins/workspace/credit-card/venv
+ _OLD_VIRTUAL_PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/snap/bin
+ PATH=/var/lib/jenkins/workspace/credit-card/venv/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/snap/bin
+ export PATH
+ [ -n  ]
+ [ -z  ]
+ _OLD_VIRTUAL_PS1=$ 
+ PS1=(venv) $ 
+ export PS1
+ VIRTUAL_ENV_PROMPT=(venv) 
+ export VIRTUAL_ENV_PROMPT
+ hash -r
+ pwd
+ export PYTHONPATH=/var/lib/jenkins/workspace/credit-card
+ python schema.py

‚ö† Dataset not found, skipping schema validation: data/processed/processed_data.csv
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (FastAPI Smoke Test)
[Pipeline] sh
üöÄ Starting FastAPI...
‚è≥ Waiting for FastAPI...

‚úÖ FastAPI is up
üì° Testing /predict...
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
100   352  100    27  100   325   1578  19001 --:--:-- --:--:-- --:--:-- 20705
{"fraud":0,"label":"Legit"}
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Docker Build & Run)
[Pipeline] sh
#0 building with "default" instance using docker driver

#1 [internal] load build definition from Dockerfile
#1 transferring dockerfile: 400B done
#1 DONE 0.0s

#2 [internal] load metadata for docker.io/library/python:3.12-slim

#2 DONE 2.3s


#3 [internal] load .dockerignore
#3 transferring context: 2B done
#3 DONE 0.0s

#4 [1/6] FROM docker.io/library/python:3.12-slim@sha256:5e2dbd4bbdd9c0e67412aea9463906f74a22c60f89eb7b5bbb7d45b66a2b68a6
#4 DONE 0.0s

#5 [internal] load build context
#5 transferring context: 4.25MB 0.6s done
#5 DONE 0.6s

#6 [2/6] WORKDIR /app
#6 CACHED

#7 [3/6] COPY requirements.txt .
#7 CACHED

#8 [4/6] RUN python -m pip install --upgrade pip
#8 CACHED

#9 [5/6] RUN pip install --no-cache-dir -r requirements.txt
#9 CACHED

#10 [6/6] COPY . .

#10 DONE 2.7s

#11 exporting to image
#11 exporting layers

#11 exporting layers 3.5s done
#11 writing image sha256:b91a51b623152b7d766d7542f890fd6aef601755b429d2eb31d7f893af779c7b done
#11 naming to docker.io/library/credit-card-fraud done
#11 DONE 3.6s

üê≥ Docker running
üÜî Container ID: d38c16c61cf88be1c9ee6f31afb596cc5f084d375b9ed8fe1530a2728294010a
üåê Port: 8882
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (FastAPI Docker Test)
[Pipeline] sh
‚è≥ Waiting for Docker FastAPI on port 8882...

‚úÖ Docker API is up
{"fraud":0,"label":"Legit"}d38c16c61cf88be1c9ee6f31afb596cc5f084d375b9ed8fe1530a2728294010a
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Archive Artifacts)
[Pipeline] archiveArtifacts
Archiving artifacts
Recording fingerprints
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Declarative: Post Actions)
[Pipeline] echo
‚úÖ Credit Card Fraud MLOps Pipeline Completed Successfully
[Pipeline] }
[Pipeline] // stage
[Pipeline] }
[Pipeline] // timeout
[Pipeline] }
[Pipeline] // withEnv
[Pipeline] }
[Pipeline] // withEnv
[Pipeline] }
[Pipeline] // node
[Pipeline] End of Pipeline
Finished: SUCCESS
